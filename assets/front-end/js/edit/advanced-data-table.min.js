!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=19)}({19:function(e,t){function a(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeout=null,this.activeCell=null,this.dragStartX=null,this.dragStartWidth=null,this.dragEl=null,this.dragging=!1,this.inlineEditInitiated=!1,this.panelActionInitiated=!1,this.initInlineEdit.bind(this),this.initPanelAction.bind(this),ea.hooks.addFilter("advancedDataTable.getClassProps","ea",this.getClassProps.bind(this)),ea.hooks.addFilter("advancedDataTable.setClassProps","ea",this.setClassProps.bind(this)),ea.hooks.addFilter("advancedDataTable.parseHTML","ea",this.parseHTML),ea.hooks.addAction("advancedDataTable.initEditor","ea",this.initEditor.bind(this)),ea.hooks.addAction("advancedDataTable.updateFromModel","ea",this.updateFromModel.bind(this)),ea.hooks.addAction("advancedDataTable.updateFromView","ea",this.updateFromView.bind(this)),elementor.hooks.addFilter("elements/widget/contextMenuGroups",this.initContextMenu),elementor.hooks.addAction("panel/open_editor/widget/eael-advanced-data-table",this.initPanel.bind(this))}var t,n,o;return t=e,(n=[{key:"updateFromModel",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.remoteRender=n,elementor.config.version>"2.7.6"){var o=t.settings.attributes;Object.keys(a).forEach((function(e){o[e]=a[e]})),parent.window.$e.run("document/elements/settings",{container:t,settings:o,options:{external:n}})}else Object.keys(a).forEach((function(t){e.setSetting(t,a[t])}));this.timeout=setTimeout((function(){e.remoteRender=!0}),1001)}},{key:"updateFromView",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.model;if(n.remoteRender=a,elementor.config.version>"2.7.6"){var o=e.getContainer(),i=e.getContainer().settings.attributes;Object.keys(t).forEach((function(e){i[e]=t[e]})),parent.window.$e.run("document/elements/settings",{container:o,settings:i,options:{external:a}})}else Object.keys(t).forEach((function(e){n.setSetting(e,t[e])}));this.timeout=setTimeout((function(){n.remoteRender=!0}),1001)}},{key:"getClassProps",value:function(){return{activeCell:this.activeCell}}},{key:"setClassProps",value:function(e){var t=this;Object.keys(e).forEach((function(a){t[a]=e[a]}))}},{key:"parseHTML",value:function(e){return e.querySelectorAll("th, td").forEach((function(e){e.querySelector(".inline-editor")&&(e.innerHTML=e.querySelector(".inline-editor").innerHTML)})),e}},{key:"initEditor",value:function(){tinymce.remove(".inline-editor"),tinymce.init({selector:".inline-editor",skin:"oxide-dark",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1})}},{key:"initInlineEdit",value:function(e,t){var a=this;if(!this.inlineEditInitiated)var n=setInterval((function(){if(t.el.querySelector(".ea-advanced-data-table")){a.inlineEditInitiated=!0;var o=t.el.querySelector(".ea-advanced-data-table-".concat(e.attributes.id));o.querySelectorAll("th, td").forEach((function(e){e.innerHTML='<div class="inline-editor">'.concat(e.innerHTML,"</div>")})),o.classList.contains("ea-advanced-data-table-editable")&&a.initEditor(),o.addEventListener("mousedown",(function(e){e.stopPropagation(),"th"===e.target.tagName.toLowerCase()&&(a.dragging=!0,a.dragEl=e.target,a.dragStartX=e.pageX,a.dragStartWidth=e.target.offsetWidth),"th"===e.target.tagName.toLowerCase()||"td"===e.target.tagName.toLowerCase()?a.activeCell=e.target:"th"===e.target.parentNode.tagName.toLowerCase()||"td"===e.target.parentNode.tagName.toLowerCase()?a.activeCell=e.target.parentNode:"th"!==e.target.parentNode.parentNode.tagName.toLowerCase()&&"td"!==e.target.parentNode.parentNode.tagName.toLowerCase()||(a.activeCell=e.target.parentNode.parentNode)})),o.addEventListener("mousemove",(function(e){a.dragging&&(a.dragEl.style.width="".concat(a.dragStartWidth+(event.pageX-a.dragStartX),"px"))})),o.addEventListener("mouseup",(function(e){if(a.dragging)if(a.dragging=!1,clearTimeout(a.timeout),o.classList.contains("ea-advanced-data-table-static")){var n=a.parseHTML(o.cloneNode(!0));a.updateFromView(t,{ea_adv_data_table_static_html:n.innerHTML})}else{var i=[];o.querySelectorAll("th").forEach((function(e,t){i[t]=e.style.width})),a.updateFromView(t,{ea_adv_data_table_dynamic_th_width:i})}})),o.addEventListener("DOMSubtreeModified",(function(e){if(o.classList.contains("ea-advanced-data-table-static")){clearTimeout(a.timeout);var n=a.parseHTML(o.cloneNode(!0));a.updateFromView(t,{ea_adv_data_table_static_html:n.innerHTML})}})),o.addEventListener("dblclick",(function(e){if("th"===e.target.tagName.toLowerCase())if(e.stopPropagation(),clearTimeout(a.timeout),o.classList.contains("ea-advanced-data-table-static")){var n=a.parseHTML(o.cloneNode(!0));a.updateFromView(t,{ea_adv_data_table_static_html:n.innerHTML})}else{var i=[];o.querySelectorAll("th").forEach((function(e,t){i[t]=e.style.width})),a.updateFromView(t,{ea_adv_data_table_dynamic_th_width:i})}}))}clearInterval(n)}),100)}},{key:"initPanelAction",value:function(e,t,a){var n=this;this.panelActionInitiated||e.el.addEventListener("click",(function(o){if(n.panelActionInitiated=!0,"ea:advTable:export"==event.target.dataset.event){for(var i=a.el.querySelector(".ea-advanced-data-table-".concat(t.attributes.id)),l=i.querySelectorAll("table tr"),r=[],d=0;d<l.length;d++){var s=[],c=l[d].querySelectorAll("th, td");if(i.classList.contains("ea-advanced-data-table-static"))for(var u=0;u<c.length;u++)s.push(JSON.stringify(c[u].innerHTML.trim()));else for(var v=0;v<c.length;v++)s.push(JSON.stringify(c[v].innerHTML.replace(/(\r\n|\n|\r)/gm," ").trim()));r.push(s.join(","))}var b=new Blob([r.join("\n")],{type:"text/csv"}),_=parent.document.createElement("a");_.classList.add("ea-adv-data-table-download-".concat(t.attributes.id)),_.download="ea-adv-data-table-".concat(t.attributes.id,".csv"),_.href=window.URL.createObjectURL(b),_.style.display="none",parent.document.body.appendChild(_),_.click(),parent.document.querySelector(".ea-adv-data-table-download-".concat(t.attributes.id)).remove()}else if("ea:advTable:import"==event.target.dataset.event){var p=e.el.querySelector(".ea_adv_table_csv_string"),h=e.el.querySelector(".ea_adv_table_csv_string_table").checked,m=p.value.split("\n"),f="",g="";p.value.length>0&&(g+="<tbody>",m.forEach((function(e,t){e.length>0&&(cols=e.match(/("(?:[^"\\]|\\.)*"|[^","]+)/gm),cols.length>0&&(h&&0==t?(f+="<thead><tr>",cols.forEach((function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?f+="<th>".concat(JSON.parse(e),"</th>"):f+="<th>".concat(e,"</th>")})),f+="</tr></thead>"):(g+="<tr>",cols.forEach((function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?g+="<td>".concat(JSON.parse(e),"</td>"):g+="<td>".concat(e,"</td>")})),g+="</tr>")))})),g+="</tbody>",(f.length>0||g.length>0)&&n.updateFromView(a,{ea_adv_data_table_static_html:f+g},!0)),p.value=""}else if("ea:advTable:connect"==event.target.dataset.event){var T=event.target;T.innerHTML="Connecting",jQuery.ajax({url:localize.ajaxurl,type:"post",data:{action:"connect_remote_db",security:localize.nonce,host:t.attributes.settings.attributes.ea_adv_data_table_source_remote_host,username:t.attributes.settings.attributes.ea_adv_data_table_source_remote_username,password:t.attributes.settings.attributes.ea_adv_data_table_source_remote_password,database:t.attributes.settings.attributes.ea_adv_data_table_source_remote_database},success:function(t){if(1==t.connected){T.innerHTML="Connected",ea.hooks.doAction("advancedDataTable.updateFromView",a,{ea_adv_data_table_source_remote_connected:!0,ea_adv_data_table_source_remote_tables:t.tables},!0),e.content.el.querySelector(".elementor-section-title").click(),e.content.el.querySelector(".elementor-section-title").click();var n=e.el.querySelector('[data-setting="ea_adv_data_table_source_remote_table"]');n.length=0,t.tables.forEach((function(e,t){n[t]=new Option(e,e)}))}else T.innerHTML="Failed"},error:function(){T.innerHTML="Failed"}}),setTimeout((function(){T.innerHTML="Connect"}),2e3)}else"ea:advTable:disconnect"==event.target.dataset.event&&(ea.hooks.doAction("advancedDataTable.updateFromView",a,{ea_adv_data_table_source_remote_connected:!1,ea_adv_data_table_source_remote_tables:[]},!0),e.content.el.querySelector(".elementor-section-title").click(),e.content.el.querySelector(".elementor-section-title").click())}))}},{key:"initPanel",value:function(e,t,a){var n=this;this.initInlineEdit(t,a),this.initPanelAction(e,t,a),t.on("remote:render",(function(){n.inlineEditInitiated=!1,n.initInlineEdit(t,a)})),setTimeout((function(){var a=e.el.querySelector('[data-setting="ea_adv_data_table_source_remote_table"]');null!=a&&0==a.length&&t.attributes.settings.attributes.ea_adv_data_table_source_remote_tables.forEach((function(e,n){a[n]=new Option(e,e,!1,e==t.attributes.settings.attributes.ea_adv_data_table_source_remote_table)}))}),50),e.el.addEventListener("mousedown",(function(a){(a.target.classList.contains("elementor-section-title")||a.target.parentNode.classList.contains("elementor-panel-navigation-tab"))&&setTimeout((function(){var a=e.el.querySelector('[data-setting="ea_adv_data_table_source_remote_table"]');null!=a&&0==a.length&&t.attributes.settings.attributes.ea_adv_data_table_source_remote_tables.forEach((function(e,n){a[n]=new Option(e,e,!1,e==t.attributes.settings.attributes.ea_adv_data_table_source_remote_table)}))}),50)}))}},{key:"initContextMenu",value:function(e,t){return"eael-advanced-data-table"==t.options.model.attributes.widgetType&&"static"==t.options.model.attributes.settings.attributes.ea_adv_data_table_source&&e.push({name:"ea_advanced_data_table",actions:[{name:"add_row_above",title:"Add Row Above",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a&&"th"!=a.tagName.toLowerCase()){for(var n=a.parentNode.rowIndex,o=e.insertRow(n),i=0;i<e.rows[0].cells.length;i++){var l=o.insertCell(i);l.innerHTML='<div class="inline-editor">'.concat(l.innerHTML,"</div>")}ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var r=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:r.innerHTML})}}},{name:"add_row_below",title:"Add Row Below",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a){for(var n=a.parentNode.rowIndex+1,o=e.insertRow(n),i=0;i<e.rows[0].cells.length;i++){var l=o.insertCell(i);l.innerHTML='<div class="inline-editor">'.concat(l.innerHTML,"</div>")}ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var r=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:r.innerHTML})}}},{name:"add_column_left",title:"Add Column Left",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a){for(var n=a.cellIndex,o=0;o<e.rows.length;o++)if("th"==e.rows[o].cells[0].tagName.toLowerCase()){var i=e.rows[o].insertBefore(document.createElement("th"),e.rows[o].cells[n]);i.innerHTML='<div class="inline-editor">'.concat(i.innerHTML,"</div>")}else{var l=e.rows[o].insertCell(n);l.innerHTML='<div class="inline-editor">'.concat(l.innerHTML,"</div>")}ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var r=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:r.innerHTML})}}},{name:"add_column_right",title:"Add Column Right",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a){for(var n=a.cellIndex+1,o=0;o<e.rows.length;o++)if("th"==e.rows[o].cells[0].tagName.toLowerCase()){var i=e.rows[o].insertBefore(document.createElement("th"),e.rows[o].cells[n]);i.innerHTML='<div class="inline-editor">'.concat(i.innerHTML,"</div>")}else{var l=e.rows[o].insertCell(n);l.innerHTML='<div class="inline-editor">'.concat(l.innerHTML,"</div>")}ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var r=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:r.innerHTML})}}},{name:"delete_row",title:"Delete Row",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a){var n=a.parentNode.rowIndex;e.deleteRow(n),ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var o=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:o.innerHTML})}}},{name:"delete_column",title:"Delete Column",callback:function(){var e=document.querySelector(".ea-advanced-data-table-".concat(t.options.model.attributes.id)),a=ea.hooks.applyFilters("advancedDataTable.getClassProps").activeCell;if(null!==a){for(var n=a.cellIndex,o=0;o<e.rows.length;o++)e.rows[o].deleteCell(n);ea.hooks.applyFilters("advancedDataTable.setClassProps",{activeCell:null}),ea.hooks.doAction("advancedDataTable.initEditor");var i=ea.hooks.applyFilters("advancedDataTable.parseHTML",e.cloneNode(!0));ea.hooks.doAction("advancedDataTable.updateFromModel",t.options.model,t.container,{ea_adv_data_table_static_html:i.innerHTML})}}}]}),e}}])&&a(t.prototype,n),o&&a(t,o),e}();ea.hooks.addAction("editMode.init","ea",(function(){new n}))}});