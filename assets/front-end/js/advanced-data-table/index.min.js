var advanced_data_table_timeout,advanced_data_table_drag_start_x,advanced_data_table_drag_start_width,advanced_data_table_drag_el,advanced_data_table_active_cell=null,advanced_data_table_dragging=!1,Advanced_Data_Table_Update_View=function(e,a,t){var n=e.model;if(n.remoteRender=a,"2.7.6"<elementor.config.version){var d=e.getContainer(),r=e.getContainer().settings.attributes;Object.keys(t).forEach(function(e){r[e]=t[e]}),parent.window.$e.run("document/elements/settings",{container:d,settings:r,options:{external:a}})}else Object.keys(t).forEach(function(e){n.setSetting(e,t[e])});advanced_data_table_timeout=setTimeout(function(){n.remoteRender=!0},1001)},Advanced_Data_Table_Update_Model=function(a,e,t,n){if(a.remoteRender=t,"2.7.6"<elementor.config.version){var d=e.settings.attributes;Object.keys(n).forEach(function(e){d[e]=n[e]}),parent.window.$e.run("document/elements/settings",{container:e,settings:d,options:{external:t}})}else Object.keys(n).forEach(function(e){a.setSetting(e,n[e])});advanced_data_table_timeout=setTimeout(function(){a.remoteRender=!0},1001)},Advanced_Data_Table=function(e,a){var s=e.context.querySelector(".ea-advanced-data-table"),t=e.context.querySelector(".ea-advanced-data-table-search"),v=e.context.querySelector(".ea-advanced-data-table-pagination"),u={};if(isEditMode)s.classList.add("ea-advanced-data-table-editable"),s.querySelectorAll("th, td").forEach(function(e){var a=e.innerHTML;0!==a.indexOf('<textarea rows="1">')&&(e.innerHTML='<textarea rows="1">'+a+"</textarea>")}),s.addEventListener("mousedown",function(e){"th"===e.target.tagName.toLowerCase()&&(e.stopPropagation(),advanced_data_table_dragging=!0,advanced_data_table_drag_el=e.target,advanced_data_table_drag_start_x=e.pageX,advanced_data_table_drag_start_width=e.target.offsetWidth)}),document.addEventListener("mousemove",function(e){advanced_data_table_dragging&&(advanced_data_table_drag_el.style.width=advanced_data_table_drag_start_width+(event.pageX-advanced_data_table_drag_start_x)+"px")}),document.addEventListener("mouseup",function(e){advanced_data_table_dragging=advanced_data_table_dragging&&!1});else if(t&&t.addEventListener("input",function(e){var a=this.value.toLowerCase(),t=0<v.querySelectorAll(".ea-advanced-data-table-pagination-current").length;if(1<s.rows.length)if(0<a.length){v.style.display="none";for(var n=1;n<s.rows.length;n++){var d=!1;if(0<s.rows[n].cells.length)for(var r=0;r<s.rows[n].cells.length;r++)if(-1<s.rows[n].cells[r].textContent.toLowerCase().indexOf(a)){d=!0;break}s.rows[n].style.display=d?"table-row":"none"}}else if(v.style.display="",t){var l=v.querySelector(".ea-advanced-data-table-pagination-current").dataset.page,o=(l-1)*s.dataset.itemsPerPage+1,c=l*s.dataset.itemsPerPage;for(n=1;n<=s.rows.length-1;n++)s.rows[n].style.display=o<=n&&n<=c?"table-row":"none"}else for(n=1;n<=s.rows.length-1;n++)s.rows[n].style.display="table-row"}),s.classList.contains("ea-advanced-data-table-sortable")&&s.addEventListener("click",function(e){if("th"===e.target.tagName.toLowerCase()){var a=e.target.cellIndex,t=e.target.classList.toggle("desc"),n=!0,d=0<v.querySelectorAll(".ea-advanced-data-table-pagination-current").length,r=1,l=1,o=s.rows.length-1;for(d&&(l=((r=v.querySelector(".ea-advanced-data-table-pagination-current").dataset.page)-1)*s.dataset.itemsPerPage+1,o=o-(r-1)*s.dataset.itemsPerPage>=s.dataset.itemsPerPage?r*s.dataset.itemsPerPage:o),u[r]=[],s.querySelectorAll("th").forEach(function(e){u[r].push(e.classList.contains("desc"))});n;){n=!1;for(var c=l;c<o;c++){var i=s.rows[c].cells[a],_=s.rows[c+1].cells[a];if(_=isNaN(parseInt(i.innerText))||isNaN(parseInt(_.innerText))?(i=i.innerText.toLowerCase(),_.innerText.toLowerCase()):(i=parseInt(i.innerText),parseInt(_.innerText)),!0===t&&i<_){s.rows[c].parentNode.insertBefore(s.rows[c+1],s.rows[c]),n=!0;break}if(!1===t&&_<i){s.rows[c].parentNode.insertBefore(s.rows[c+1],s.rows[c]),n=!0;break}}}}}),s.classList.contains("ea-advanced-data-table-paginated")){var n="",d=1,r=1,l=d*s.dataset.itemsPerPage,o=Math.ceil((s.rows.length-1)/s.dataset.itemsPerPage);if(1<o){for(var c=1;c<=o;c++)n+='<a href="#" data-page="'+c+'" class="'+(1==c?"ea-advanced-data-table-pagination-current":"")+'">'+c+"</a>";v.insertAdjacentHTML("beforeend",'<a href="#" data-page="1">&laquo;</a>'+n+'<a href="#" data-page="'+o+'">&raquo;</a>')}for(c=0;c<=l&&!(c>=s.rows.length);c++)s.rows[c].style.display="table-row";v.addEventListener("click",function(e){if(e.preventDefault(),"a"==e.target.tagName.toLowerCase()){d=e.target.dataset.page,r=(d-1)*s.dataset.itemsPerPage+1,l=d*s.dataset.itemsPerPage,v.querySelectorAll(".ea-advanced-data-table-pagination-current").forEach(function(e){e.classList.remove("ea-advanced-data-table-pagination-current")}),v.querySelectorAll('[data-page="'+d+'"]').forEach(function(e){e.classList.add("ea-advanced-data-table-pagination-current")});for(var a=1;a<=s.rows.length-1;a++)s.rows[a].style.display=r<=a&&a<=l?"table-row":"none";s.querySelectorAll("th").forEach(function(e,a){e.classList.remove("desc"),void 0!==u[d]&&u[d][a]&&e.classList.add("desc")})}})}},Advanced_Data_Table_Click_Handler=function(e,a,t){if("ea:advTable:export"==event.target.dataset.event){for(var n=t.el.querySelector(".ea-advanced-data-table-"+a.attributes.id).querySelectorAll("table tr"),d=[],r=0;r<n.length;r++){for(var l=[],o=n[r].querySelectorAll("th, td"),c=0;c<o.length;c++)l.push(JSON.stringify(o[c].querySelector("textarea").value.replace(/(\r\n|\n|\r)/gm," ").trim()));d.push(l.join(","))}var i=new Blob([d.join("\n")],{type:"text/csv"}),_=parent.document.createElement("a");_.classList.add("ea-adv-data-table-download-"+a.attributes.id),_.download="ea-adv-data-table-"+a.attributes.id+".csv",_.href=window.URL.createObjectURL(i),_.style.display="none",parent.document.body.appendChild(_),_.click(),parent.document.querySelector(".ea-adv-data-table-download-"+a.attributes.id).remove()}else if("ea:advTable:import"==event.target.dataset.event){var s=e.el.querySelector(".ea_adv_table_csv_string"),v=e.el.querySelector(".ea_adv_table_csv_string_table").checked,u=s.value.split("\n"),b="",f="";0<s.value.length&&(f+="<tbody>",u.forEach(function(e,a){0<(o=e.match(/"([^\\"]|\\")*"/g)||e.split(",")).length&&(v&&0==a?(b+="<thead><tr>",o.forEach(function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?b+="<th>"+JSON.parse(e)+"</th>":b+="<th>"+e+"</th>"}),b+="</tr></thead>"):(f+="<tr>",o.forEach(function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?f+="<td>"+JSON.parse(e)+"</td>":f+="<td>"+e+"</td>"}),f+="</tr>"))}),f+="</tbody>",(0<b.length||0<f.length)&&Advanced_Data_Table_Update_View(t,!0,{ea_adv_data_table_static_html:b+f})),s.value=""}},Advanced_Data_Table_Inline_Edit=function(e,a,n){function t(){var e=setInterval(function(){if(n.el.querySelector(".ea-advanced-data-table")){var t=n.el.querySelector(".ea-advanced-data-table-"+a.attributes.id);t.addEventListener("focusin",function(e){"textarea"==e.target.tagName.toLowerCase()&&(advanced_data_table_active_cell=e.target)}),t.addEventListener("input",function(e){if("textarea"==e.target.tagName.toLowerCase()){clearTimeout(advanced_data_table_timeout);var a=t.cloneNode(!0);a.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_View(n,!1,{ea_adv_data_table_static_html:a.innerHTML})}}),t.addEventListener("mouseup",function(e){if("th"===e.target.tagName.toLowerCase()){clearTimeout(advanced_data_table_timeout);var a=t.cloneNode(!0);a.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_View(n,!1,{ea_adv_data_table_static_html:a.innerHTML})}}),t.addEventListener("dblclick",function(e){"th"===e.target.tagName.toLowerCase()&&(e.stopPropagation(),e.target.style.width="")}),clearInterval(e)}},10)}t(),a.on("remote:render",function(){t()});var d=Advanced_Data_Table_Click_Handler.bind(this,e,a,n);e.el.addEventListener("click",d),e.currentPageView.on("destroy",function(){e.el.removeEventListener("click",d)})};Advanced_Data_Table_Context_Menu=function(e,r){return"eael-advanced-data-table"==r.options.model.attributes.widgetType&&e.push({name:"ea_advanced_data_table",actions:[{name:"add_row_above",title:"Add Row Above",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell&&"th"!=advanced_data_table_active_cell.parentNode.tagName.toLowerCase()){for(var a=advanced_data_table_active_cell.parentNode.parentNode.rowIndex,t=e.insertRow(a),n=0;n<e.rows[0].cells.length;n++){t.insertCell(n).innerHTML='<textarea rows="1"></textarea>'}advanced_data_table_active_cell=null;var d=e.cloneNode(!0);d.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:d.innerHTML})}}},{name:"add_row_below",title:"Add Row Below",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var a=advanced_data_table_active_cell.parentNode.parentNode.rowIndex+1,t=e.insertRow(a),n=0;n<e.rows[0].cells.length;n++){t.insertCell(n).innerHTML='<textarea rows="1"></textarea>'}advanced_data_table_active_cell=null;var d=e.cloneNode(!0);d.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:d.innerHTML})}}},{name:"add_column_left",title:"Add Column Left",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var a=advanced_data_table_active_cell.parentNode.cellIndex,t=0;t<e.rows.length;t++){if("th"==e.rows[t].cells[0].tagName.toLowerCase())var n=e.rows[t].insertBefore(document.createElement("th"),e.rows[t].cells[a]);else n=e.rows[t].insertCell(a);n.innerHTML='<textarea rows="1"></textarea>'}advanced_data_table_active_cell=null;var d=e.cloneNode(!0);d.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:d.innerHTML})}}},{name:"add_column_right",title:"Add Column Right",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var a=advanced_data_table_active_cell.parentNode.cellIndex+1,t=0;t<e.rows.length;t++){if("th"==e.rows[t].cells[0].tagName.toLowerCase())var n=e.rows[t].insertBefore(document.createElement("th"),e.rows[t].cells[a]);else n=e.rows[t].insertCell(a);n.innerHTML='<textarea rows="1"></textarea>'}advanced_data_table_active_cell=null;var d=e.cloneNode(!0);d.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:d.innerHTML})}}},{name:"delete_row",title:"Delete Row",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell){var a=advanced_data_table_active_cell.parentNode.parentNode.rowIndex;e.deleteRow(a),advanced_data_table_active_cell=null;var t=e.cloneNode(!0);t.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:t.innerHTML})}}},{name:"delete_column",title:"Delete Column",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+r.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var a=advanced_data_table_active_cell.parentNode.cellIndex,t=0;t<e.rows.length;t++)e.rows[t].deleteCell(a);advanced_data_table_active_cell=null;var n=e.cloneNode(!0);n.querySelectorAll("th, td").forEach(function(e){var a=e.querySelector("textarea").value;e.innerHTML=a}),Advanced_Data_Table_Update_Model(r.options.model,r.container,!1,{ea_adv_data_table_static_html:n.innerHTML})}}}]}),e},jQuery(window).on("elementor/frontend/init",function(){isEditMode&&(elementor.hooks.addFilter("elements/widget/contextMenuGroups",Advanced_Data_Table_Context_Menu),elementor.hooks.addAction("panel/open_editor/widget/eael-advanced-data-table",Advanced_Data_Table_Inline_Edit)),elementorFrontend.hooks.addAction("frontend/element_ready/eael-advanced-data-table.default",Advanced_Data_Table)});