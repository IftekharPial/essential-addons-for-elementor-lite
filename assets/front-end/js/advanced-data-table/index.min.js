var advanced_data_table_timeout,advanced_data_table_drag_start_x,advanced_data_table_drag_start_width,advanced_data_table_drag_el,advanced_data_table_active_cell=null,advanced_data_table_dragging=!1,Advanced_Data_Table_Update_View=function(e,t,a){var n=e.model;if(n.remoteRender=t,"2.7.6"<elementor.config.version){var l=e.getContainer(),d=e.getContainer().settings.attributes;Object.keys(a).forEach(function(e){d[e]=a[e]}),parent.window.$e.run("document/elements/settings",{container:l,settings:d,options:{external:t}})}else Object.keys(a).forEach(function(e){n.setSetting(e,a[e])});advanced_data_table_timeout=setTimeout(function(){n.remoteRender=!0},1001)},Advanced_Data_Table_Update_Model=function(t,e,a,n){if(t.remoteRender=a,"2.7.6"<elementor.config.version){var l=e.settings.attributes;Object.keys(n).forEach(function(e){l[e]=n[e]}),parent.window.$e.run("document/elements/settings",{container:e,settings:l,options:{external:a}})}else Object.keys(n).forEach(function(e){t.setSetting(e,n[e])});advanced_data_table_timeout=setTimeout(function(){t.remoteRender=!0},1001)},Advanced_Data_Table=function(e,n){var u=e.context.querySelector(".ea-advanced-data-table"),t=e.context.querySelector(".ea-advanced-data-table-search"),v=e.context.querySelector(".ea-advanced-data-table-pagination"),b={};if(isEditMode)u.querySelectorAll("th, td").forEach(function(e){var t=e.innerHTML;0!==t.indexOf('<div class="inline-edit">')&&(e.innerHTML='<div class="inline-edit">'+t+"</div>")});else{if(t&&t.addEventListener("input",function(e){var t=this.value.toLowerCase(),a=u.classList.contains("ea-advanced-data-table-sortable"),n="thead"==u.rows[0].parentNode.tagName.toLowerCase()?1:0;if(1<u.rows.length)if(0<t.length){a&&u.classList.add("ea-advanced-data-table-unsortable"),v&&0<v.innerHTML.length&&(v.style.display="none");for(var l=n;l<u.rows.length;l++){var d=!1;if(0<u.rows[l].cells.length)for(var r=0;r<u.rows[l].cells.length;r++)if(-1<u.rows[l].cells[r].textContent.toLowerCase().indexOf(t)){d=!0;break}u.rows[l].style.display=d?"table-row":"none"}}else if(a&&u.classList.remove("ea-advanced-data-table-unsortable"),v&&0<v.innerHTML.length){v.style.display="";var o=v.querySelector(".ea-advanced-data-table-pagination-current").dataset.page,i=(o-1)*u.dataset.itemsPerPage+1,c=o*u.dataset.itemsPerPage;for(l=1;l<=u.rows.length-1;l++)u.rows[l].style.display=i<=l&&l<=c?"table-row":"none"}else for(l=1;l<=u.rows.length-1;l++)u.rows[l].style.display="table-row"}),u.classList.contains("ea-advanced-data-table-sortable")&&u.addEventListener("click",function(e){if("th"===e.target.tagName.toLowerCase()){var t=e.target.cellIndex,a=1,n=1,l=u.rows.length-1,d="",r=e.target.classList,o=[],i=u.cloneNode(!0);d=r.contains("asc")?(e.target.classList.remove("asc"),e.target.classList.add("desc"),"desc"):(r.contains("desc")&&e.target.classList.remove("desc"),e.target.classList.add("asc"),"asc"),v&&0<v.innerHTML.length&&(a=v.querySelector(".ea-advanced-data-table-pagination-current").dataset.page,n=(a-1)*u.dataset.itemsPerPage+1,l=l-(a-1)*u.dataset.itemsPerPage>=u.dataset.itemsPerPage?a*u.dataset.itemsPerPage:l),b[a]=[],u.querySelectorAll("th").forEach(function(e){e.cellIndex!=t&&e.classList.remove("asc","desc"),b[a].push(e.classList.contains("asc")?"asc":e.classList.contains("desc")?"desc":"")});for(var c=n;c<=l;c++){var s,_=u.rows[c].cells[t];s=isNaN(parseInt(_.innerText))?_.innerText.toLowerCase():parseInt(_.innerText),o.push({index:c,value:s})}"asc"==d?o.sort(function(e,t){return e.value>t.value?1:-1}):"desc"==d&&o.sort(function(e,t){return e.value<t.value?1:-1}),o.forEach(function(e,t){u.rows[n+t].innerHTML=i.rows[e.index].innerHTML})}}),u.classList.contains("ea-advanced-data-table-paginated")){var a="",l=v.classList.contains("ea-advanced-data-table-pagination-button")?"button":"select",d=1,r="thead"==u.rows[0].parentNode.tagName.toLowerCase()?1:0,o=d*u.dataset.itemsPerPage,i=Math.ceil((u.rows.length-1)/u.dataset.itemsPerPage);if(1<i)if("button"==l){for(var c=1;c<=i;c++)a+='<a href="#" data-page="'+c+'" class="'+(1==c?"ea-advanced-data-table-pagination-current":"")+'">'+c+"</a>";v.insertAdjacentHTML("beforeend",'<a href="#" data-page="1">&laquo;</a>'+a+'<a href="#" data-page="'+i+'">&raquo;</a>')}else{for(c=1;c<=i;c++)a+='<option value="'+c+'">'+c+"</option>";v.insertAdjacentHTML("beforeend","<select>"+a+"</select>")}for(c=0;c<=o&&!(c>=u.rows.length);c++)u.rows[c].style.display="table-row";"button"==l?v.addEventListener("click",function(e){if(e.preventDefault(),"a"==e.target.tagName.toLowerCase()){d=e.target.dataset.page,offset="thead"==u.rows[0].parentNode.tagName.toLowerCase()?1:0,r=(d-1)*u.dataset.itemsPerPage+offset,o=d*u.dataset.itemsPerPage,v.querySelectorAll(".ea-advanced-data-table-pagination-current").forEach(function(e){e.classList.remove("ea-advanced-data-table-pagination-current")}),v.querySelectorAll('[data-page="'+d+'"]').forEach(function(e){e.classList.add("ea-advanced-data-table-pagination-current")});for(var t=offset;t<=u.rows.length-1;t++)u.rows[t].style.display=r<=t&&t<=o?"table-row":"none";u.querySelectorAll("th").forEach(function(e,t){e.classList.remove("asc","desc"),void 0!==b[d]&&b[d][t]&&e.classList.add(b[d][t])})}}):v.hasChildNodes()&&v.querySelector("select").addEventListener("input",function(e){e.preventDefault(),d=e.target.value,offset="thead"==u.rows[0].parentNode.tagName.toLowerCase()?1:0,r=(d-1)*u.dataset.itemsPerPage+offset,o=d*u.dataset.itemsPerPage;for(var t=offset;t<=u.rows.length-1;t++)u.rows[t].style.display=r<=t&&t<=o?"table-row":"none";u.querySelectorAll("th").forEach(function(e,t){e.classList.remove("asc","desc"),void 0!==b[d]&&b[d][t]&&e.classList.add(b[d][t])})})}u.querySelectorAll(".nt_button_woo").forEach(function(e){e.classList.add("add_to_cart_button","ajax_add_to_cart")}),u.querySelectorAll(".nt_woo_quantity").forEach(function(e){e.addEventListener("input",function(e){var t=e.target.dataset.product_id,a=e.target.value;n(".nt_add_to_cart_"+t,n(u)).data("quantity",a)})})}},Advanced_Data_Table_Inline_Edit=function(e,l,d){function t(){var e=setInterval(function(){if(d.el.querySelector(".ea-advanced-data-table")){var n=d.el.querySelector(".ea-advanced-data-table-"+l.attributes.id);n.classList.contains("ea-advanced-data-table-editable")&&tinymce.init({selector:".inline-edit",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1}),n.addEventListener("mousedown",function(e){e.stopPropagation(),console.log("mos"),"th"===e.target.tagName.toLowerCase()&&(advanced_data_table_dragging=!0,advanced_data_table_drag_el=e.target,advanced_data_table_drag_start_x=e.pageX,advanced_data_table_drag_start_width=e.target.offsetWidth),"th"===e.target.tagName.toLowerCase()||"td"===e.target.tagName.toLowerCase()?advanced_data_table_active_cell=e.target:"th"===e.target.parentNode.tagName.toLowerCase()||"td"===e.target.parentNode.tagName.toLowerCase()?advanced_data_table_active_cell=e.target.parentNode:"th"!==e.target.parentNode.parentNode.tagName.toLowerCase()&&"td"!==e.target.parentNode.parentNode.tagName.toLowerCase()||(advanced_data_table_active_cell=e.target.parentNode.parentNode)}),n.addEventListener("mousemove",function(e){advanced_data_table_dragging&&(advanced_data_table_drag_el.style.width=advanced_data_table_drag_start_width+(event.pageX-advanced_data_table_drag_start_x)+"px")}),n.addEventListener("mouseup",function(e){if(advanced_data_table_dragging)if(advanced_data_table_dragging=!1,clearTimeout(advanced_data_table_timeout),n.classList.contains("ea-advanced-data-table-static")){var t=n.cloneNode(!0);t.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_View(d,!1,{ea_adv_data_table_static_html:t.innerHTML})}else{var a=[];n.querySelectorAll("th").forEach(function(e,t){a[t]=e.style.width}),Advanced_Data_Table_Update_View(d,!1,{ea_adv_data_table_dynamic_th_width:a})}}),n.addEventListener("input",function(e){if(n.classList.contains("ea-advanced-data-table-static")){clearTimeout(advanced_data_table_timeout);var t=n.cloneNode(!0);t.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_View(d,!1,{ea_adv_data_table_static_html:t.innerHTML})}}),n.addEventListener("dblclick",function(e){if("th"===e.target.tagName.toLowerCase())if(e.stopPropagation(),clearTimeout(advanced_data_table_timeout),n.classList.contains("ea-advanced-data-table-static")){var t=n.cloneNode(!0);t.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_View(d,!1,{ea_adv_data_table_static_html:t.innerHTML})}else{var a=[];n.querySelectorAll("th").forEach(function(e,t){a[t]=e.style.width}),Advanced_Data_Table_Update_View(d,!1,{ea_adv_data_table_dynamic_th_width:a})}}),clearInterval(e)}},10)}t(),l.on("remote:render",function(){t()});var a=Advanced_Data_Table_Click_Handler.bind(this,e,l,d);e.el.addEventListener("click",a),e.currentPageView.on("destroy",function(){e.el.removeEventListener("click",a)});function n(){setTimeout(function(){var a=e.el.querySelector('[data-setting="ea_adv_data_table_source_remote_table"]');null!=a&&0==a.length&&l.attributes.settings.attributes.ea_adv_data_table_source_remote_tables.forEach(function(e,t){a[t]=new Option(e,e,!1,e==l.attributes.settings.attributes.ea_adv_data_table_source_remote_table)})},50)}n(),e.el.addEventListener("mousedown",function(e){(e.target.classList.contains("elementor-section-title")||e.target.parentNode.classList.contains("elementor-panel-navigation-tab"))&&n()})},Advanced_Data_Table_Click_Handler=function(t,e,n){if("ea:advTable:export"==event.target.dataset.event){for(var a=n.el.querySelector(".ea-advanced-data-table-"+e.attributes.id),l=a.querySelectorAll("table tr"),d=[],r=0;r<l.length;r++){var o=[],i=l[r].querySelectorAll("th, td");if(a.classList.contains("ea-advanced-data-table-static"))for(var c=0;c<i.length;c++)o.push(JSON.stringify(i[c].innerHTML.trim()));else for(c=0;c<i.length;c++)o.push(JSON.stringify(i[c].innerHTML.replace(/(\r\n|\n|\r)/gm," ").trim()));d.push(o.join(","))}var s=new Blob([d.join("\n")],{type:"text/csv"}),_=parent.document.createElement("a");_.classList.add("ea-adv-data-table-download-"+e.attributes.id),_.download="ea-adv-data-table-"+e.attributes.id+".csv",_.href=window.URL.createObjectURL(s),_.style.display="none",parent.document.body.appendChild(_),_.click(),parent.document.querySelector(".ea-adv-data-table-download-"+e.attributes.id).remove()}else if("ea:advTable:import"==event.target.dataset.event){var u=t.el.querySelector(".ea_adv_table_csv_string"),v=t.el.querySelector(".ea_adv_table_csv_string_table").checked,b=u.value.split("\n"),m="",g="";0<u.value.length&&(g+="<tbody>",b.forEach(function(e,t){0<e.length&&0<(i=e.match(/("(?:[^"\\]|\\.)*"|[^","]+)/gm)).length&&(v&&0==t?(m+="<thead><tr>",i.forEach(function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?m+="<th>"+JSON.parse(e)+"</th>":m+="<th>"+e+"</th>"}),m+="</tr></thead>"):(g+="<tr>",i.forEach(function(e){e.match(/(^"")|(^")|("$)|(""$)/g)?g+="<td>"+JSON.parse(e)+"</td>":g+="<td>"+e+"</td>"}),g+="</tr>"))}),g+="</tbody>",(0<m.length||0<g.length)&&Advanced_Data_Table_Update_View(n,!0,{ea_adv_data_table_static_html:m+g})),u.value=""}else if("ea:advTable:connect"==event.target.dataset.event){var f=event.target;f.innerHTML="Connecting",jQuery.ajax({url:localize.ajaxurl,type:"post",data:{action:"connect_remote_db",security:localize.nonce,host:e.attributes.settings.attributes.ea_adv_data_table_source_remote_host,username:e.attributes.settings.attributes.ea_adv_data_table_source_remote_username,password:e.attributes.settings.attributes.ea_adv_data_table_source_remote_password,database:e.attributes.settings.attributes.ea_adv_data_table_source_remote_database},success:function(e){if(1==e.connected){f.innerHTML="Connected",Advanced_Data_Table_Update_View(n,!0,{ea_adv_data_table_source_remote_connected:!0,ea_adv_data_table_source_remote_tables:e.tables}),t.content.el.querySelector(".elementor-section-title").click(),t.content.el.querySelector(".elementor-section-title").click();var a=t.el.querySelector('[data-setting="ea_adv_data_table_source_remote_table"]');a.length=0,e.tables.forEach(function(e,t){a[t]=new Option(e,e)})}else f.innerHTML="Failed"},error:function(){f.innerHTML="Failed"}}),setTimeout(function(){f.innerHTML="Connect"},2e3)}else"ea:advTable:disconnect"==event.target.dataset.event&&(Advanced_Data_Table_Update_View(n,!0,{ea_adv_data_table_source_remote_connected:!1,ea_adv_data_table_source_remote_tables:[]}),t.content.el.querySelector(".elementor-section-title").click(),t.content.el.querySelector(".elementor-section-title").click())};Advanced_Data_Table_Context_Menu=function(e,d){return"eael-advanced-data-table"==d.options.model.attributes.widgetType&&"static"==d.options.model.attributes.settings.attributes.ea_adv_data_table_source&&e.push({name:"ea_advanced_data_table",actions:[{name:"add_row_above",title:"Add Row Above",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell&&"th"!=advanced_data_table_active_cell.tagName.toLowerCase()){for(var t=advanced_data_table_active_cell.parentNode.rowIndex,a=e.insertRow(t),n=0;n<e.rows[0].cells.length;n++){a.insertCell(n).classList.add("inline-edit")}advanced_data_table_active_cell=null,tinymce.init({selector:".ea-advanced-data-table-editable th, .ea-advanced-data-table-editable td",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1});var l=e.cloneNode(!0);l.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:l.innerHTML})}}},{name:"add_row_below",title:"Add Row Below",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var t=advanced_data_table_active_cell.parentNode.rowIndex+1,a=e.insertRow(t),n=0;n<e.rows[0].cells.length;n++){a.insertCell(n).classList.add("inline-edit")}advanced_data_table_active_cell=null,tinymce.init({selector:".ea-advanced-data-table-editable th, .ea-advanced-data-table-editable td",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1});var l=e.cloneNode(!0);l.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:l.innerHTML})}}},{name:"add_column_left",title:"Add Column Left",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var t=advanced_data_table_active_cell.cellIndex,a=0;a<e.rows.length;a++){if("th"==e.rows[a].cells[0].tagName.toLowerCase())var n=e.rows[a].insertBefore(document.createElement("th"),e.rows[a].cells[t]);else n=e.rows[a].insertCell(t);n.classList.add("inline-edit")}advanced_data_table_active_cell=null,tinymce.init({selector:".ea-advanced-data-table-editable th, .ea-advanced-data-table-editable td",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1});var l=e.cloneNode(!0);l.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:l.innerHTML})}}},{name:"add_column_right",title:"Add Column Right",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var t=advanced_data_table_active_cell.cellIndex+1,a=0;a<e.rows.length;a++){if("th"==e.rows[a].cells[0].tagName.toLowerCase())var n=e.rows[a].insertBefore(document.createElement("th"),e.rows[a].cells[t]);else n=e.rows[a].insertCell(t);n.classList.add("inline-edit")}advanced_data_table_active_cell=null,tinymce.init({selector:".ea-advanced-data-table-editable th, .ea-advanced-data-table-editable td",menubar:!1,inline:!0,plugins:["lists","link","autolink"],toolbar:"bold italic underline strikethrough link | alignleft aligncenter alignright | numlist bullist",forced_root_block:!1});var l=e.cloneNode(!0);l.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:l.innerHTML})}}},{name:"delete_row",title:"Delete Row",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell){var t=advanced_data_table_active_cell.parentNode.rowIndex;e.deleteRow(t),advanced_data_table_active_cell=null;var a=e.cloneNode(!0);a.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:a.innerHTML})}}},{name:"delete_column",title:"Delete Column",callback:function(){var e=document.querySelector(".ea-advanced-data-table-"+d.options.model.attributes.id);if(null!==advanced_data_table_active_cell){for(var t=advanced_data_table_active_cell.cellIndex,a=0;a<e.rows.length;a++)e.rows[a].deleteCell(t);advanced_data_table_active_cell=null;var n=e.cloneNode(!0);n.querySelectorAll("th, td").forEach(function(e){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("contenteditable"),e.removeAttribute("spellcheck")}),Advanced_Data_Table_Update_Model(d.options.model,d.container,!1,{ea_adv_data_table_static_html:n.innerHTML})}}}]}),e},jQuery(window).on("elementor/frontend/init",function(){isEditMode&&(elementor.hooks.addFilter("elements/widget/contextMenuGroups",Advanced_Data_Table_Context_Menu),elementor.hooks.addAction("panel/open_editor/widget/eael-advanced-data-table",Advanced_Data_Table_Inline_Edit)),elementorFrontend.hooks.addAction("frontend/element_ready/eael-advanced-data-table.default",Advanced_Data_Table)});